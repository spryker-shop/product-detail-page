{% block pageTitle -%}
    {{ _view.product.metaTitle | default(_view.product.name) }}
{%- endblock %}
{% block pageKeywords -%}
    {{ _view.product.metaKeywords | default(null) }}
{%- endblock %}
{% block pageDescription -%}
    {{ _view.product.metaDescription | default(null) }}
{%- endblock %}

{% block breadcrumbItems %}
    {{ widget('ProductCategoryWidgetPlugin', _view.product, app.locale) }}
{% endblock %}

{% block title %}
    <h3 itemprop="name">{{ _view.product.name }}</h3>
    <link itemprop="url" href="{{ _view.productUrl }}" />
{% endblock %}

{% block outside %}
    {{ widgetBlock('ProductImageWidgetPlugin', 'smallView', _view.product) }}
{% endblock %}

{% block content %}
    <div class="row">
        <div class="small-12 medium-6 xlarge-7 xxlarge-8 columns">
            <div style="position: relative">
                {{ widgetBlock('ProductImageWidgetPlugin', 'largeView', _view.product) }}

                {{ widget('ProductAbstractLabelWidgetPlugin', _view.product) }}
            </div>
        </div>

        <div class="small-12 medium-6 xlarge-5 xxlarge-4 columns">

            <div class="callout">
                {% if _view.product.attributes.brand is defined %}<h5><small>{{ 'page.product.by' | trans }}</small> {{ _view.product.attributes.brand }}</h5>{% endif %}

                {{ widget('PriceWidgetPlugin', _view.product) }}

                <small>{{ 'product.attribute.sku' | trans }}: {{ _view.product.sku }}</small>

                {{ widgetBlock('ProductReviewWidgetPlugin', 'rating', _view.product.idProductAbstract) }}

                {% include '@ProductDetailPage/_product-detail-page/_partials/variants.twig' %}
            </div>

            {{ widget('ProductGroupWidgetPlugin', _view.product.idProductAbstract) }}

            <form method="POST" action="/cart/add/{{ _view.product.sku }}">

                {{ widget('ProductOptionWidgetPlugin', _view.product) }}

                <div class="callout">
                    <div class="row">
                        <div class="small-4 xlarge-3 columns __no-margin-bottom">
                            <select name="quantity" class="__no-margin-bottom">
                                {% for index in 1..10 %}
                                    <option value="{{ index }}">{{ index }}</option>
                                {% endfor %}
                            </select>
                        </div>

                        <div class="small-8 xlarge-9 columns">
                            {% if widgetExists('AvailabilityWidgetPlugin') %}
                                {% set disabled = not widgetBlock('AvailabilityWidgetPlugin', 'isAvailable', _view.product) or _view.product.price is null %}
                            {% else %}
                                {% set disabled = (_view.product.idProductConcrete is not defined or _view.product.price is null) %}
                            {% endif %}

                            <button type="submit" class="button expanded success js-add-to-cart-button __no-margin-bottom" {{ disabled ? 'disabled' : '' }} onclick="this.form.submit(); this.disabled='disabled'; return false;">
                                <i class="fa fa-cart-plus"></i>{{ 'page.detail.add-to-cart' | trans }}
                            </button>
                        </div>
                    </div>

                    {{ widgetBlock('AvailabilityWidgetPlugin', 'outOfStock', _view.product) }}
                </div>
            </form>

            {{ widget('WishlistWidgetPlugin', _view.product) }}
        </div>
    </div>

    <div class="row">
        <div class="small-12 columns">
            <div class="callout">
                <h5>{{ 'product.attribute.long_description' | trans }}</h5>
                <p>{{ _view.product.description }}</p>

                <h5>{{ 'page.product.details' | trans }}</h5>
                <div class="row">
                    {% for attributeName, attributeValue in _view.product.attributes if attributeName  %}

                        <p class="small-12 medium-6 xlarge-4 xxlarge-3 columns" itemprop="additionalProperty" itemscope itemtype="http://schema.org/PropertyValue">
                            <strong itemprop="name">{{ ('product.attribute.'~attributeName) | trans }} </strong><br>
                            <span itemprop="value">{{ attributeValue }}</span>
                        </p>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>

    {{ widgetBlock('ProductReviewWidgetPlugin', 'reviews', _view.product.idProductAbstract) }}

    {{ widget('SimilarProductsWidgetPlugin', _view.product) }}

    {{ widget('ProductCmsBlockWidgetPlugin', _view.product) }}

{% endblock %}
